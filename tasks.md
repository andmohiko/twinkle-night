# 🎨 twinkle night MV 再現 Web サイト 開発タスク指示書

## 🌟 概要

「twinkle night feat.somunia（nyankobrq & yaca）」の MV の世界に入り込める Web サイトを制作。  
ユーザーは自分のアバター画像をアップロードし、MV のようにふわふわと浮遊しながら夜の街を移動できる体験を得られる。

## 🧱 技術スタック

- **フロントエンド**: Next.js App Router / TypeScript / Mantine / Canvas API
- **バックエンド**: Python / FastAPI
- **インフラ**:
  - フロントエンド：Vercel
  - バックエンド：Cloud Run
  - ストレージ：Firebase Cloud Storage

---

## ✅ 1. プロジェクト初期化

- [x] Next.js + Mantine + Canvas 構成のセットアップ
- [ ] FastAPI の初期プロジェクト作成
- [x] Cloud Storage バケット作成（アップロード・公開設定）
- [ ] GitHub リポジトリ作成 & CI/CD パイプライン準備（Vercel + Cloud Run）

---

## 🖼️ 2. 画像アップロード機能

### フロントエンド

- [ ] 画像アップロード UI の実装（最大 3 枚まで）
- [ ] アップロード済み画像のプレビュー表示
- [ ] 「変換する」ボタン実装
- [ ] Cloud Storage for Firebase に画像をアップロード
- [ ] アップロード画像のオブジェクト URL を取得

---

## 🎨 3. 画像加工処理（FastAPI）

- [ ] 背景除去（remove.bg API or U-2-Net）
- [ ] 横顔生成（可能であれば、難易度高）
- [ ] ドット絵変換（画像縮小 + 色数減少処理）
- [ ] 加工後画像を Cloud Storage へ保存
- [ ] 加工済み画像 URL をクライアントに返却

---

## 🌃 4. MV 世界の再現（Canvas）

- [x] MV 風の夜の街背景を準備（ループできるように）
- [x] 背景の横スクロール処理
- [ ] アップロード画像の描画
- [ ] アバターごとに上下にふわふわ浮遊するアニメーション

---

## 🎵 5. 音楽再生機能

- [ ] YouTube 埋め込みによる BGM ループ再生（UI 非表示）
  - または音源データを直接再生（ライセンス確認要）

---

## 🔐 6. セキュリティと制限

- [ ] アップロード画像のサイズ・形式バリデーション（フロント + API）
- [ ] 最大 3 枚までのアップロード制限
- [ ] Firebase Storage Rules の設定
- [ ] API キー・認証（必要に応じて）

---

## 🚀 7. デプロイ & 動作確認

- [ ] フロントエンド：Vercel へデプロイ（環境変数設定）
- [ ] バックエンド：Cloud Run へデプロイ（Dockerfile 準備）
- [ ] 動作確認 & テスト実施

---

## 🔄 8. 今後の拡張アイデア（任意）

- [ ] アバターに表情・ポーズをつける
- [ ] パララックス効果を背景に追加
- [ ] 他ユーザーのアバターも表示（擬似的な多人数表現）
